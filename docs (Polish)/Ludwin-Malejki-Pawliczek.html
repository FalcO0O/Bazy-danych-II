<h1 id="mini-projekt-bazy-danych-ii">Mini Projekt - Bazy Danych II</h1>
<h2 id="aplikacja-aukcyjna-backend-i-frontend">Aplikacja Aukcyjna - Backend i Frontend</h2>
<h3 id="autorzy-">Autorzy:</h3>
<ul>
<li><strong>Bartosz Ludwin</strong></li>
<li><strong>Filip Malejki</strong></li>
<li><strong>Mateusz Pawliczek</strong></li>
</ul>
<p>Link do repozytorium GitHub: <a href="https://github.com/FalcO0O/Bazy-danych-II">https://github.com/FalcO0O/Bazy-danych-II</a></p>
<hr>
<h2 id="wprowadzenie">Wprowadzenie</h2>
<p>Projekt stanowi implementację <strong>pełnej aplikacji aukcyjnej</strong> składającej się z backendu oraz frontendu. Umożliwia on tworzenie aukcji oraz licytowanie ich przez użytkowników. Informacje są przechowywane w systemie bazodanowym, w którym znajdują się dane o użytkownikach, aukcjach oraz logi transakcji.</p>
<hr>
<h2 id="technologie">Technologie</h2>
<p>Projekt został zrealizowany przy użyciu następujących technologii:</p>
<h3 id="backend">Backend</h3>
<ul>
<li><strong>Python + FastAPI</strong></li>
<li><strong>Baza danych</strong>: MongoDB</li>
<li><strong>Komunikacja z bazą</strong>: Motor (asynchroniczny klient MongoDB) + PyMongo</li>
</ul>
<h3 id="frontend">Frontend</h3>
<ul>
<li><strong>Interfejs użytkownika</strong> dostępny pod adresem <strong>localhost:3000</strong></li>
</ul>
<h3 id="-rodowisko-uruchomieniowe">Środowisko uruchomieniowe</h3>
<ul>
<li><strong>Docker</strong> z Docker Compose</li>
</ul>
<p>Dodatkowo wykorzystano biblioteki do:</p>
<ul>
<li>obsługi zapytań HTTP,</li>
<li>szyfrowania haseł,</li>
<li>tworzenia i walidacji tokenów JWT.</li>
</ul>
<hr>
<h2 id="uruchomienie-aplikacji">Uruchomienie aplikacji</h2>
<p>Aplikacja składa się z backendu i frontendu, które są uruchamiane jednocześnie za pomocą Docker Compose:</p>
<pre><code class="lang-sh"><span class="hljs-attribute">docker compose up</span>
</code></pre>
<p>Po uruchomieniu:</p>
<ul>
<li><strong>Frontend</strong> będzie dostępny pod adresem: <strong><a href="http://localhost:3000">http://localhost:3000</a></strong></li>
<li><strong>Backend API</strong> będzie dostępny zgodnie z konfiguracją Docker Compose</li>
</ul>
<hr>
<h2 id="funkcjonalno-ci">Funkcjonalności</h2>
<p>API aplikacji aukcyjnej umożliwia:</p>
<ul>
<li>Rejestrację użytkownika i logowanie do systemu.</li>
<li>Obsługę tokenów JWT i mechanizmu odświeżania tokenów (refresh token).</li>
<li>Tworzenie nowych aukcji lub ich zamknięcie przez zalogowanych użytkowników.</li>
<li>Edycję i usuwanie aukcji przez administratora.</li>
<li>Licytowanie aukcji przez użytkowników z weryfikacją poprawności oferty.</li>
<li>Ręczne zakończenie aukcji przez administratora.</li>
<li><p>Generowanie raportów zawierających:</p>
<ul>
<li>zestawienie aktywnych i zakończonych aukcji,</li>
<li>statystyki użytkowników,</li>
<li>informacje o przepływach finansowych.</li>
</ul>
</li>
<li><p>Logowanie działań użytkowników (logowanie, rejestracja konta)</p>
</li>
<li>Logowanie zmian aukcji (utworzenie, zamknięcie, licytowanie)</li>
</ul>
<p>Backend zapewnia poprawne wykonanie powyższych operacji poprzez wykorzystanie <strong>systemu transakcji</strong>. Jest to szczególnie istotne w przypadku konkurencyjnych operacji, takich jak licytacje, gdzie wiele ofert może być składanych jednocześnie.</p>
<p><strong>Frontend</strong> zapewnia intuicyjny interfejs użytkownika umożliwiający korzystanie ze wszystkich funkcjonalności aplikacji aukcyjnej bez konieczności bezpośredniego korzystania z API.</p>
<hr>
<h2 id="mo-liwe-udoskonalenia">Możliwe udoskonalenia</h2>
<p>Aktualnie aukcje są kończone ręcznie przez właściciela aukcji lub administratora. Możliwym usprawnieniem byłoby wprowadzenie mechanizmu automatycznego zamykania aukcji na podstawie ustalonej daty zakończenia.</p>
<hr>
<h2 id="dokumentacja">Dokumentacja</h2>
<p>W ramach projektu przygotowano osobny plik <code>dokumentacja.pdf</code>, który zawiera szczegółowy opis każdego endpointu umożliwiającego komunikację z serwerem i modyfikację danych w bazie.</p>
<p><strong>Dokumentacja zawiera:</strong></p>
<ul>
<li>Opis działania każdego endpointu.</li>
<li>Schemat danych wejściowych i wyjściowych.</li>
<li>Informację o typie odpowiedzi HTTP <em>(kody statusu)</em>.</li>
<li>Przykładowe zapytania i odpowiedzi w formacie JSON.</li>
<li>Informację o wymaganiach walidacyjnych <em>(np. minimalna długość hasła, wymagane pola)</em>.</li>
</ul>
<hr>
<h2 id="testowanie-race-condition">Testowanie Race Condition</h2>
<p>W celu weryfikacji działania systemu transakcji użytego w endpointach licytacji, przygotowano dedykowany program testujący symulujący warunki wyścigu (race condition).</p>
<p>Testy są uruchamiane na osobnej, testowej bazie danych, co zapewnia bezpieczeństwo i izolację środowiska.</p>
<h3 id="wymagania">Wymagania</h3>
<p>Do uruchomienia testu potrzebny jest interpreter <strong>Python</strong>. Można go pobrać ze strony: <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></p>
<hr>
<h3 id="opis-testu">Opis testu</h3>
<p>Test obejmuje następujące kroki:</p>
<ul>
<li>Rejestrację lub logowanie trzech kont testowych.</li>
<li>Utworzenie aukcji przez użytkownika A.</li>
<li>Trzykrotne synchroniczne licytowanie tej aukcji przez użytkowników B i C (równocześnie).</li>
<li>Zamknięcie aukcji przez użytkownika A.</li>
</ul>
<hr>
<h3 id="uruchomienie-testu">Uruchomienie testu</h3>
<p>Aby uruchomić test:</p>
<ol>
<li><p>Przejdź do folderu <code>testing</code>:</p>
<pre><code class="lang-sh"> <span class="hljs-built_in">cd</span> testing
</code></pre>
</li>
<li><p>Pobierz wymagane dependencje jeśli jeszcze tego nie zrobiłeś:</p>
<pre><code class="lang-sh"> pip <span class="hljs-keyword">install</span> httpx asyncio
</code></pre>
</li>
<li><p>Uruchom skrypt:</p>
<pre><code class="lang-sh"> <span class="hljs-keyword">py</span> racetest.<span class="hljs-keyword">py</span>
</code></pre>
</li>
</ol>
<p>Test zostanie wykonany, a wyniki pojawią się w konsoli.</p>
<hr>
<h3 id="przyk-adowe-wyniki-">Przykładowe wyniki:</h3>
<pre><code>[!] test-user-xkawofngyh131 already <span class="hljs-built_in">exists</span>, trying <span class="hljs-keyword">to</span> login...
[!] test-user-jjkoelfmah125 already <span class="hljs-built_in">exists</span>, trying <span class="hljs-keyword">to</span> login...
[!] test-user-kdrihnekog232 already <span class="hljs-built_in">exists</span>, trying <span class="hljs-keyword">to</span> login...
✅ Auction created: <span class="hljs-number">6845</span>fca72bda3f4afc7ac07c
[BID] Statu<span class="hljs-variable">s:</span> <span class="hljs-number">200</span>, Amoun<span class="hljs-variable">t:</span> <span class="hljs-number">150</span>, Response: {<span class="hljs-string">"id"</span>:<span class="hljs-string">"6845fca72bda3f4afc7ac07e"</span>, ...
[BID] Statu<span class="hljs-variable">s:</span> <span class="hljs-number">400</span>, Amoun<span class="hljs-variable">t:</span> <span class="hljs-number">150</span>, Response: {<span class="hljs-string">"detail"</span>:<span class="hljs-comment">"Kwota oferty musi być wyższa ...</span>
[BID] Statu<span class="hljs-variable">s:</span> <span class="hljs-number">200</span>, Amoun<span class="hljs-variable">t:</span> <span class="hljs-number">200</span>, Response: {<span class="hljs-string">"id"</span>:<span class="hljs-string">"6845fca92bda3f4afc7ac080"</span>, ...
[BID] Statu<span class="hljs-variable">s:</span> <span class="hljs-number">400</span>, Amoun<span class="hljs-variable">t:</span> <span class="hljs-number">200</span>, Response: {<span class="hljs-string">"detail"</span>:<span class="hljs-comment">"Kwota oferty musi być wyższa ...</span>
[BID] Statu<span class="hljs-variable">s:</span> <span class="hljs-number">200</span>, Amoun<span class="hljs-variable">t:</span> <span class="hljs-number">250</span>, Response: {<span class="hljs-string">"id"</span>:<span class="hljs-string">"6845fca92bda3f4afc7ac082"</span>, ...
[BID] Statu<span class="hljs-variable">s:</span> <span class="hljs-number">400</span>, Amoun<span class="hljs-variable">t:</span> <span class="hljs-number">250</span>, Response: {<span class="hljs-string">"detail"</span>:<span class="hljs-comment">"Kwota oferty musi być wyższa ...</span>
✅ Auction <span class="hljs-number">6845</span>fca72bda3f4afc7ac07c closed.
</code></pre><p>Jak widać, system transakcji zapobiega konfliktom — tylko jedna oferta o danej kwocie jest zaakceptowana, a pozostałe są odrzucane.
W przypadku błędu transakcyjnego mogłoby dojść do zaakceptowania tej samej kwoty wielokrotnie.</p>
